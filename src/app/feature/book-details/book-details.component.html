<div class="min-h-screen bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 py-8">
    <!-- Breadcrumb -->
    <app-breadcrumb [items]="breadcrumbItems()" />

    <!-- Loading State -->
    @if (isLoading()) {
    <app-loading-spinner />
    }

    <!-- Error State -->
    @else if (hasError()) {
    <app-empty-state
      message="Livro não encontrado"
      description="O livro que você está procurando não existe ou foi removido"
    />
    }

    <!-- Book Details -->
    @else if (book()) {
    <div class="grid md:grid-cols-3 gap-8">
      <!-- Coluna da imagem -->
      <div class="md:col-span-1">
        <div class="card sticky top-8">
          <img
            [src]="bookImage"
            [alt]="book()!.title"
            class="w-full h-auto rounded-lg border border-gray-200 mb-4"
          />

          <!-- Add to Library Button -->
          <app-add-to-library-button [bookId]="book()!.id" />
        </div>
      </div>

      <!-- Coluna de informações -->
      <div class="md:col-span-2 space-y-6">
        <!-- Título e Autores -->
        <div>
          <h1 class="text-4xl font-bold text-gray-900 mb-2">
            {{ book()!.title }}
          </h1>
          <p class="text-xl text-gray-600">{{ authorsText }}</p>
        </div>

        <!-- Rating -->
        @if (book()!.averageRating) {
        <div>
          <app-rating-display [rating]="book()!.averageRating!" size="lg" />
        </div>
        }

        <!-- Gêneros -->
        @if (book()!.genres.length > 0) {
        <div>
          <h3 class="font-semibold text-gray-900 mb-2">Gêneros</h3>
          <div class="flex flex-wrap gap-2">
            @for (genre of book()!.genres; track genre.id) {
            <span class="chip">{{ genre.name }}</span>
            }
          </div>
        </div>
        }

        <!-- Descrição -->
        @if (book()!.description) {
        <div>
          <h3 class="font-semibold text-gray-900 mb-2">Sobre o livro</h3>
          <p class="text-gray-700 leading-relaxed whitespace-pre-line">
            {{ book()!.description }}
          </p>
        </div>
        }

        <!-- Informações adicionais -->
        <div class="card bg-gray-50">
          <h3 class="font-semibold text-gray-900 mb-4">Informações</h3>
          <dl class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            @if (formattedPublishedDate) {
            <div>
              <dt class="text-sm text-gray-600">Data de Publicação</dt>
              <dd class="text-gray-900 font-medium">{{ formattedPublishedDate }}</dd>
            </div>
            }

            @if (book()!.pageCount) {
            <div>
              <dt class="text-sm text-gray-600">Páginas</dt>
              <dd class="text-gray-900 font-medium">{{ book()!.pageCount }}</dd>
            </div>
            }

            @if (book()!.language) {
            <div>
              <dt class="text-sm text-gray-600">Idioma</dt>
              <dd class="text-gray-900 font-medium">{{ book()!.language }}</dd>
            </div>
            }

            @if (book()!.isbn) {
            <div>
              <dt class="text-sm text-gray-600">ISBN</dt>
              <dd class="text-gray-900 font-medium font-mono text-sm">{{ book()!.isbn }}</dd>
            </div>
            }
          </dl>
        </div>

        <!-- Autores detalhados -->
        @if (book()!.authors.length > 0) {
        <div>
          <h3 class="font-semibold text-gray-900 mb-3">
            {{ book()!.authors.length === 1 ? 'Autor' : 'Autores' }}
          </h3>
          <div class="space-y-2">
            @for (author of book()!.authors; track author.id) {
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center">
                <span class="text-primary-600 font-semibold">
                  {{ author.name.charAt(0).toUpperCase() }}
                </span>
              </div>
              <span class="text-gray-700">{{ author.name }}</span>
            </div>
            }
          </div>
        </div>
        }
      </div>
    </div>
    }
  </div>
</div>
